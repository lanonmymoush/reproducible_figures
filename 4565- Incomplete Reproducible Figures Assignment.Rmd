---
title: "Homework Template"
output:
  pdf_document: default
  html_document: default
date: "2023-10-09"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
options(repos = c(CRAN = "https://cran.r-project.org"))
```

*Please Knit your .rmd to a PDF format or HTML and submit that with no identifiers like your name.*

*To create a PDF, first install tinytex and load the package. Then press the Knit arrow and select "Knit to PDF".*

## QUESTION 01: Data Visualisation for Science Communication

**Create a figure using the Palmer Penguin dataset that is correct but badly communicates the data. **Do not make a boxplot**.**

In this figure, I will be comparing body mass and sex in Adelie penguins to determine if there is a difference in body mass between males and females. To do this, I will create a violin plot which communicates the data "badly". I have filtered the dataset to contain only Adelie penguins so that a comparison can be drawn between the males and females of the same species. I have also created a new dataset containing only these penguins, and no NAs to make the data easier to work with. 

### a) Provide your figure here:

```{r bad figure code, include=FALSE}
install.packages("ggplot2")
install.packages("palmerpenguins")
install.packages("janitor")
install.packages("dplyr")
install.packages("tidyverse")
library(ggplot2)
library(palmerpenguins)
library(janitor)
library(dplyr)
library(tidyverse)
print(penguins_raw)
filter(penguins_raw, Species == "Adelie Penguin (Pygoscelis adeliae)")
Adelie <- filter(penguins_raw, Species == "Adelie Penguin (Pygoscelis adeliae)", !is.na(Sex))
Adelie
Adelie <- rename(Adelie, "body_mass_g" = `Body Mass (g)`)
Adelie
```

```{r}
ggplot(Adelie, aes(x = Sex, y = body_mass_g) )+
  geom_violin(colour = "#7f7f7f", fill = "#7f7f7f")+
  geom_point(colour = "#7f7f7f")+
  labs(x = " ", y = " ")+
  theme_dark()+
  scale_x_discrete(labels = NULL)
```


### b) Write about how your design choices mislead the reader about the underlying data (200-300 words).
To begin, I created an exploratory violin plot comparing the body mass (g) of male and female Adelie penguins. This displayed the data very basically and allowed for simple data exploration. To badly display the data however, I began to alter the properties of the plot. To do this, I changed the theme of the plot from the default theme to the dark theme which produces a plot which a dark grey background. I then matched the colour of the violin, violin outline, and plotted points to match the background of the dark theme by changing the hex code of each component. The colour matching of these components with the background means that it is difficult for the reader to distinguish the violin, and the points. The reader could gain a vague understanding of where the violins are on the plot by observing where the grid lines are absent, however this method will not accurately allow the reader to reflect on potential summary statistics and variation within the raw data points, and instead may incite more confusion in the reader. I also removed axes titles from both the x and y axes and the axes labels from the x axis so that the reader cannot determine which variables are being investigated. This means that although the data *is* technically displayed, it is very difficult to observe and draw conclusions, making it difficult to understand the graph, thus misleading the reader. 


------------------------------------------------------------------------

## QUESTION 2: Data Pipeline

*Write a data analysis pipeline in your .rmd RMarkdown file. You should be aiming to write a clear explanation of the steps, the figures visible, as well as clear code.*

## Creating a data pipeline 
### Write a data analysis pipeline in your .rmd file. write a clear explanation of the steps as well as clear code. 

### Introduction
The palmerspenguins dataset contains a variety of categorical and continuous variables for data analysis. In this instance, I am interested in one categorical variable, sex, and a continuous variable, body mass (g), as I would expect body mass to vary depending on sex, i.e males should be larger, and females should be smaller. There are multiple species of penguins in this dataset, Adelie, Chinstrap, and Gentoo, however, I will be focusing on only one species, Adelie. Based on the variables of interest, a violin plot could be produced to show the difference in body mass between males and females of the same species, and also demonstrate the variability and distribution of body mass within the species. Thus, accompanied by the suitable statistical tests, a violin plot will be used to visualise the differences in body mass between male and female Adelie penguins. 

### Hypothesis 
In this pipeline, the null hypothesis will be that there is no significant difference in mean body mass between male and female Adelie penguins. The experimental two-tailed hypothesis will be that there is a significant difference in mean body mass between male and female Adelie penguins. These hypotheses will be tested with a one-way ANOVA (analysis of variance) which will determine if the difference is significant. 

### Methodology 
To address these hypotheses, the palmerpenguins dataset needs to be cleaned and filtered to contain only the relevant data, i.e. only the Adelie penguins, and remove any NAs from the categorical column. This cleaned and filtered tibble can then be used to create an exploratory figure, run an ANOVA, and create a results figure. 

```{r Exploratory Plot, echo=TRUE}
# Install the necessary packages for the analysis, and also load them into the dataset.
install.packages("ggplot2")
install.packages("palmerpenguins")
install.packages("janitor")
install.packages("dplyr")
install.packages("tidyverse")
library(ggplot2)
library(palmerpenguins)
library(janitor)
library(dplyr)
library(tidyverse)
# The print function is used to "print" a table containing the raw data, 
# therefore allowing viewing of the dataset. 
print(penguins_raw) 
# The names() function allows readers to observe the names of the columns within
# the dataset, which will allow us to determine which parts of the dataset need cleaning. 
names(penguins_raw) 
```


The execution of this code shows that the column names of this dataset have comments and despite being human readable, they are not readable for R. This needs changing. To do this, the comments should be removed. 
```{r}
cleanpenguins <- select(penguins_raw,-starts_with("Delta"))
cleanpenguins <- select(cleanpenguins,-Comments)
names(cleanpenguins)
```

You should then re run the names() function with the newly assigned tibble to determine if the code is successful and has removed the comments from the penguins_raw dataset. 

The execution of this code has removed the comments from the dataset which makes it more readable for R. To continue to clean the data, the data should be filtered to remove species that are not going to be analysed, and also remove NAs in the sex column so that they are not analysed in the data. The code below filters the tibble to include only one species of penguins, Pygoscelis adeliae, and also removes any individual data points where the sex of the penguin was inconclusive (identified by an NA in the Sex column). This ensures that the data analysis will not be influenced by individuals who have not accurately been observed and could confound our results.  
```{r}
filter(cleanpenguins, Species == "Adelie Penguin (Pygoscelis adeliae)")
Adelie <- filter(cleanpenguins, Species == "Adelie Penguin (Pygoscelis adeliae)", !is.na(Sex))
Adelie
```

After the data has been filtered to contain only adelie penguins, the column of interest, i.e. "Body Mass (g)", can be renamed so that it is more readable to R. 
```{r}
Adelie <- rename(Adelie, "body_mass_g" = `Body Mass (g)`)
Adelie 
```

Next, an exploratory figure can be made. This will begin an investigation into the differences in body mass between male and female Adelie penguins. I decided to keep the points vertically stacked rather than jittered in this plot to allow the reader to see the density of points around a specific body mass, therefore allowing for estimation of the mean.

```{r}
ggplot(Adelie, aes(x = Sex, y = body_mass_g))+
  geom_violin()+
  geom_point()
```

There appears to be some difference in the avergae body mass between males and females. 

To begin looking at the analysis of the differences in body mass, I began by creating histograms of each of the sexes to determine whether the data was normally distributed.
```{r Statistical Test, echo=TRUE}
ggplot(Adelie, aes(x = body_mass_g))+
geom_histogram()+
facet_wrap(~Sex)
penguinsmod1 <- lm(body_mass_g ~ Sex, Adelie)
```

This histogram shows that the data is relatively normally distributed, and so a one-way ANOVA (Analysis of Variance) can be used to determine if there is a significant difference in the mean body mass of male and female adelie penguins. To do this, you would first have to create and summarise a linear model. 

```{r}
summary(penguinsmod1)
```

After producing the model, a one-way ANOVA can be conducted to determine if the difference is significant. 
```{r}
anova(penguinsmod1)
```

To create the results figure, the same code that was used for the exploratory plot was used and expanded. The original code involved plotting the violins and adding points to ensure that the data is not hidden. The theme of the graph could then be changed. Black points can also be added to show the mean body masses of male and female penguins which allows for direct comparison between two groups. Titles can be added to the graph to ensure that the graphs are more easily visualised, as well as making the main title bold. The main feature of the results graph is the asterisks which demonstrate the significance between the groups. Colours of the violins were also changed to make the graph more colourblind friendly. 
```{r Results Figure, echo=TRUE}
ggplot(Adelie, aes(x = Sex, y = body_mass_g, colour = Sex))+
  geom_violin()+ 
  geom_point()+ 
  theme_bw()+
  stat_summary(fun.y = "mean", geom = "point", shape = 21, size = 3, fill = "black") + 
  labs(title = "Violin plot to show the body mass of male and female Adelie penguins", 
       y= "Body Mass (g)")+  
   theme(plot.title = element_text(face = "bold"))+ 
  annotate(geom = "text", x = 1.5, y = 5000, label = "***", size = 6)+ 
  geom_segment(aes(x = 1, xend = 2, y = 4950, yend = 4950), linetype = "solid", color = "black")+ 
  geom_segment(aes(x = 1, xend = 1, y = 4950, yend = 4850), linetype = "solid", colour = "black")+
  geom_segment(aes(x = 2, xend = 2, y = 4950, yend = 4850), linetype = "solid", colour = "black")+
  scale_colour_manual(values = c("FEMALE" = "orange", "MALE" = "blue"))  
```

### Results 
Conducting a linear regression and one-way ANOVA shows that there is a significant difference between the mean body mass of Adelie males and female penguins, meaning that the null hypothesis can be rejected and the experimental/alternative hypothesis can be accepted. With ANOVA calculating a p value smaller than 2.2e-16, it can be sensibly suggested that the results observed are not likely to be due to chance and are likely to be result of the categorical variable. Additionally, the linear regression of the model shows an R^2 value of 0.54, suggesting that approximately 54% of the variation in response variable, body mass can be explained by the explanatory variable, sex. 

### Conclusion
This analysis suggests that there is a difference in body mass between male and female Adelie penguins, however nothing more, and does not aim to explain reasons why there is a difference in body mass between male and females- this could be a point for future analysis. Overall, I believe that the analysis carried out was sensible and suitable to determine which hypothesis to accept and reject.  

------------------------------------------------------------------------

## QUESTION 3: Open Science

### a) GitHub

*Upload your RProject you created for **Question 2** and any files and subfolders used to GitHub. Do not include any identifiers such as your name. Make sure your GitHub repo is public.*

*GitHub link:*

*You will be marked on your repo organisation and readability.*

### b) Share your repo with a partner, download, and try to run their data pipeline.

*Partner's GitHub link:*

*You **must** provide this so I can verify there is no plagiarism between you and your partner.*

### c) Reflect on your experience running their code. (300-500 words)

-   *What elements of your partner's code helped you to understand their data pipeline?*

-   *Did it run? Did you need to fix anything?*

-   *What suggestions would you make for improving their code to make it more understandable or reproducible, and why?*

-   *If you needed to alter your partner's figure using their code, do you think that would be easy or difficult, and why?*

### d) Reflect on your own code based on your experience with your partner's code and their review of yours. (300-500 words)

-   *What improvements did they suggest, and do you agree?*

-   *What did you learn about writing code for other people?*
